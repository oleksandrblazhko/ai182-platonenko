### Тайм-аут тестового сеансу

| ID | 
| --- | 
| WSTG-SESS-07 |

### Резюме

На цьому етапі тестувальники перевіряють, чи програма автоматично виходить із системи користувача, коли він не використовується протягом певного часу, гарантуючи, що неможливо «повторно використовувати» той самий сеанс і що конфіденційні дані не зберігаються в кеші браузера. .

Усі додатки повинні використовувати тайм-аут простою або бездіяльності для сеансів. Цей тайм-аут визначає проміжок часу, протягом якого сеанс залишатиметься активним у разі відсутності активності користувача, закриття та визнання сеансу недійсним після визначеного періоду простою з моменту останнього запиту HTTP, отриманого веб-програмою для даного ідентифікатора сеансу. Найвідповідніший час очікування має бути балансом між безпекою (коротший час очікування) та зручністю використання (довший час очікування) і сильно залежить від рівня чутливості даних, які обробляє програма. Наприклад, 60-хвилинний час виходу з системи для публічного форуму може бути прийнятним, але такий тривалий час буде надто великим у програмі домашнього банківського обслуговування (де рекомендований максимальний час очікування становить 15 хвилин). У будь-якому випадку будь-які програми, які не застосовують вихід із системи на основі тайм-ауту, слід вважати небезпечними, якщо така поведінка не вимагається певною функціональною вимогою.

Час простою обмежує ймовірність того, що зловмисник вгадає та використовує дійсний ідентифікатор сеансу від іншого користувача, і за певних обставин може захистити публічні комп’ютери від повторного використання сеансу. Однак, якщо зловмиснику вдається захопити даний сеанс, тайм-аут простою не обмежує дії зловмисника, оскільки він може періодично генерувати активність у сеансі, щоб підтримувати сеанс активним протягом більш тривалого часу.

Управління тайм-аутом сеансу та закінченням терміну дії має здійснюватися на стороні сервера. Якщо певні дані під контролем клієнта використовуються для забезпечення тайм-ауту сеансу, наприклад, використання значень файлів cookie або інших параметрів клієнта для відстеження посилань на час (наприклад, кількість хвилин після входу в систему), зловмисник може маніпулювати ними, щоб продовжити сеанс. тривалість. Таким чином, програма має відстежувати час бездіяльності на сервері та, після закінчення часу очікування, автоматично скасовувати сеанс поточного користувача та видаляти всі дані, що зберігаються на клієнті.

Обидві дії слід виконувати обережно, щоб уникнути появи слабких місць, які можуть бути використані зловмисником для отримання неавторизованого доступу, якщо користувач забув вийти з програми. Зокрема, щодо функції виходу з системи важливо переконатися, що всі маркери сеансу (наприклад, файли cookie) належним чином знищено або зроблено непридатними для використання, і що належні засоби керування застосовуються на стороні сервера для запобігання повторному використанню маркерів сеансу. Якщо такі дії не виконуються належним чином, зловмисник може відтворити ці маркери сеансу, щоб «воскресити» сеанс законного користувача та видати себе за нього (ця атака зазвичай відома як «відтворення файлів cookie»). Звичайно, пом’якшувальним фактором є те, що зловмисник повинен мати доступ до цих маркерів (які зберігаються на комп’ютері жертви), але в багатьох випадках це може бути неможливим або особливо складним.

Найпоширенішим сценарієм такого роду атак є публічний комп’ютер, який використовується для доступу до певної приватної інформації (наприклад, веб-пошти, онлайн-банківського рахунку). Якщо користувач відходить від комп’ютера без явного виходу з системи, а тайм-аут сеансу не реалізовано в додатку, то зловмисник може отримати доступ до того самого облікового запису, просто натиснувши кнопку «назад» у браузері.

### Цілі тесту
 - Перевірте, чи існує тайм-аут жорсткого сеансу.

### Як тестувати
#### Тестування чорної скриньки
Той самий підхід, який ми бачили в розділі Перевірка функціональності виходу, можна застосувати під час вимірювання часу очікування виходу. Методологія тестування дуже схожа. По-перше, тестувальники мають перевірити, чи існує тайм-аут, наприклад, увійшовши в систему та дочекавшись, поки спрацює час очікування. Як і у функції виходу, після закінчення часу очікування всі маркери сеансу мають бути знищені або стати непридатними для використання.

Тоді, якщо тайм-аут налаштовано, тестувальники повинні зрозуміти, чи цей тайм-аут виконується клієнтом чи сервером (або обома). Якщо файл cookie сеансу є непостійним (або, загалом, файл cookie сеансу не зберігає жодних даних про час), тестувальники можуть припустити, що час очікування виконується сервером. Якщо файл cookie сеансу містить певні дані, пов’язані з часом (наприклад, час входу в систему, час останнього доступу або дата закінчення терміну дії постійного файлу cookie), тоді, можливо, клієнт бере участь у застосуванні тайм-ауту. У цьому випадку тестувальники можуть спробувати змінити файл cookie (якщо він не захищений криптографічно) і подивитися, що станеться з сеансом. Наприклад, тестувальники можуть встановити дату закінчення терміну дії файлів cookie далеко в майбутньому та побачити, чи можна продовжити сеанс.

Як правило, усе має перевірятися на стороні сервера, і не повинно бути можливого повторного доступу до програми шляхом повторного встановлення файлів cookie сеансу на попередні значення.

### Тестування сірого ящика
#### Тестер повинен перевірити, що:

- Функція виходу фактично знищує всі маркери сеансу або принаймні робить їх непридатними для використання,
- Сервер виконує належні перевірки стану сеансу, не дозволяючи зловмиснику відтворювати раніше знищені ідентифікатори сеансу
- Тайм-аут застосовується примусово, і він належним чином виконується сервером. Якщо сервер використовує час закінчення терміну дії, який зчитується з маркера сеансу, надісланого клієнтом (але це не рекомендується), тоді маркер має бути криптографічно захищений від підробки.

Зауважте, що найважливіше, щоб програма анулювала сеанс на стороні сервера. Загалом це означає, що код має викликати відповідні методи, напр. HttpSession.invalidate() у Java та Session.abandon() у .NET. Очищення файлів cookie з веб-переглядача бажано, але це не обов’язково, оскільки якщо сеанс належним чином визнано недійсним на сервері, наявність файлів cookie у браузері не допоможе зловмиснику.
